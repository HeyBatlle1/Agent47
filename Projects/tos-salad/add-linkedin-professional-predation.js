#!/usr/bin/env node

/**
 * Add LinkedIn User Agreement Analysis - Professional Predation
 *
 * This script adds LinkedIn's analysis as an example of professional predation -
 * how platforms leverage career dependency to extract professional content while
 * maintaining power over users' professional identities.
 * Transparency Score: 25/100 - Professional predation without forced arbitration.
 */

const { createClient } = require('@supabase/supabase-js');
const dotenv = require('dotenv');

dotenv.config();

const supabase = createClient(
  'https://fbjjqwfcmzrpmytieajp.supabase.co',
  process.env.SUPABASE_ANON_KEY
);

async function addLinkedInProfessionalPredation() {
  console.log('üíº Adding LinkedIn professional predation analysis...');

  const linkedinAnalysisContent = `LinkedIn User Agreement: Professional Predation Through Career Dependency
Red Flag Analysis - Leveraging Career Necessity for Content Extraction

TRANSPARENCY SCORE: 25/100 - PROFESSIONAL PREDATION CATEGORY

EXECUTIVE SUMMARY: While professionally formatted and clearly written, this agreement is fundamentally user-hostile in its core legal structure. It grants LinkedIn a sweeping, perpetual license to user content (which includes professional articles, posts, and resumes), completely disclaims all warranties, and severely limits its own liability. Most critically, it does not use forced arbitration, which is a major positive. However, it replaces it with a "home court" clause that is nearly as effective at preventing legal challenges. The low score reflects the vast power imbalance it creates in a professional context where users often have no alternative.

PROFESSIONAL PREDATION ASSESSMENT: LinkedIn leverages users' career dependency to extract high-value professional content while maintaining maximum control over professional identities. This represents a sophisticated form of exploitation that uses career necessity as leverage.

DETAILED PREDATORY CLAUSE ANALYSIS:

1. The "Everything You Post is Ours to Use" License: A Sweeping, Perpetual Right to Your Professional Content

Original Text: "You grant LinkedIn a worldwide, transferable and sublicensable right to use, copy, modify, distribute, publish and process, information and content that you provide through our Services... without any further consent, notice and/or compensation to you or others... This license is... perpetual and irrevocable."

Professional Predation Analysis: This is the foundational clause. Any content you post on LinkedIn‚Äîyour resume, articles you write, professional updates, comments‚Äîyou grant them a permanent, irreversible, free license to use, copy, modify, and distribute it. They can sell this data to others ("transferable and sublicensable") without ever paying you or asking for your permission again. You are providing the high-value professional content that powers their platform for free.

Why This Is Professional Predation: Unlike social media posts, LinkedIn content represents professional expertise, career achievements, and industry knowledge. Users are essentially giving away their professional intellectual property for free while LinkedIn monetizes it.

2. The "We Are Not Liable for Anything" Clause: A Total Disclaimer of Responsibility

Original Text: "LINKEDIN... DISCLAIM ANY AND ALL LIABILITY TO YOU FOR ANY SPECIAL, INCIDENTAL, INDIRECT, PUNITIVE, CONSEQUENTIAL DAMAGES OR... LOSS OF DATA, PROFITS, REVENUES OR REPUTATION..."

Professional Predation Analysis: This is an ironclad liability shield. If a failure by LinkedIn causes you to lose your entire professional network, critical data, or if a data breach harms your professional reputation and costs you a job, they are not legally or financially responsible for those damages. This transfers the entire professional risk of using their platform from them to you.

Why This Is Professional Predation: Career damage from platform failures can be devastating and long-lasting. LinkedIn disclaims responsibility for professional consequences while maintaining control over professional visibility.

3. The "No Warranty" Disclaimer: The Service is Not Guaranteed to Work or Be Accurate

Original Text: "LINKEDIN... DO NOT MAKE ANY REPRESENTATIONS OR WARRANTIES ABOUT THE SERVICES, INCLUDING ANY REPRESENTATION OR WARRANTY THAT THE SERVICES WILL BE UNINTERRUPTED OR ERROR-FREE... AND PROVIDE THE SERVICES (INCLUDING CONTENT AND INFORMATION) ON AN 'AS IS' AND 'AS AVAILABLE' BASIS."

Professional Predation Analysis: LinkedIn makes no legal promises that its service will work, be available, or that the information on it (including job postings or profiles) is accurate. They provide the platform with no guarantees. If you rely on their platform for your career and it fails or contains errors, you have accepted that risk.

Why This Is Professional Predation: Professional networking platforms are often essential for career advancement. Disclaiming reliability while maintaining market dominance exploits career dependency.

4. The "Home Court Advantage" (Instead of Arbitration): You Must Sue in California or Ireland

Original Text: "For others outside of Designated Countries, including those who live in the United States, you and LinkedIn agree that the laws of the State of California, U.S.A... shall govern all claims... you and LinkedIn agree that all such claims can only be litigated in the federal or state courts of Santa Clara County, California, USA..."

Professional Predation Analysis: This is a critically important clause. LinkedIn does not use forced arbitration, which is a major point in their favor. However, they replace it with this "forum selection" clause. It forces any user in the US to file their lawsuit in Santa Clara County, California. For the vast majority of users, the cost and logistical difficulty of doing this is so high that it serves the same purpose as an arbitration clause: it effectively prevents most legal challenges.

Why This Is Better Than Arbitration But Still Problematic: While users retain the right to actual courts (unlike Verizon or Chase), the geographic restriction creates a practical barrier that serves similar functions to forced arbitration.

5. Unilateral Control: They Can Change, Suspend, or End the Service at Any Time

Original Text: "We may change or discontinue any of our Services. We don't promise to store or keep showing any information and content that you've posted... LinkedIn is not a storage service. You agree that we have no obligation to store, maintain or provide you a copy of any content or information that you or others provide, except to the extent required by applicable law..."

Professional Predation Analysis: LinkedIn has the absolute right to change or shut down its services at any time. More importantly, they explicitly state they are not a storage service and have no obligation to save your data. If they decide to delete your content, your professional network, or your entire profile, this clause states they have the right to do so. You are responsible for keeping your own backups.

Why This Is Professional Predation: Your professional network and career history can disappear at LinkedIn's discretion, yet they are often seen as essential professional infrastructure.

6. The Right to Terminate Your Account at Will

Original Text: "LinkedIn can end this Contract at any time. We reserve the right to restrict, suspend, or terminate your account if you are in breach of this Contract or the law or are misusing the Services..."

Professional Predation Analysis: This clause gives LinkedIn the right to terminate your professional online identity on their platform if they believe you have violated their rules. Given the importance of LinkedIn in many industries, this gives them significant power over a user's career prospects and professional network.

Why This Is Professional Predation: Professional platform bans can have career-ending consequences, yet LinkedIn maintains unilateral termination power without appeal processes.

PROFESSIONAL PREDATION FRAMEWORK ANALYSIS:

LinkedIn's Professional Predation Strategy:

‚Ä¢ Career Dependency Exploitation: Leverage professional necessity to extract content
‚Ä¢ Professional Content Appropriation: Permanent rights to career expertise and achievements
‚Ä¢ Professional Risk Transfer: Users bear all consequences of platform failures
‚Ä¢ Professional Identity Control: Unilateral power over career networking infrastructure
‚Ä¢ Geographic Legal Barriers: California-only courts practically prevent most challenges
‚Ä¢ Professional Data Abandonment: No obligation to preserve career-critical information

THE SIGNAL COUNTER-NARRATIVE COMPARISON:

Signal's Approach: ‚úÖ No content licenses, ‚úÖ Court access preserved, ‚úÖ No professional data exploitation
LinkedIn's Approach: ‚ùå Perpetual professional content license, ‚ö†Ô∏è Courts restricted to California, ‚ùå Career dependency exploitation

POSITIVE DISTINCTION: NO FORCED ARBITRATION

Unlike Verizon, Chase, and Spotify, LinkedIn does NOT use forced arbitration. This is a significant distinction that preserves fundamental legal rights, even if geographic restrictions make exercise of those rights difficult.

WHAT LINKEDIN REVEALS ABOUT PROFESSIONAL PLATFORM CAPITALISM:

LinkedIn proves that platforms can leverage career dependency as effectively as legal coercion. When a platform becomes essential for professional success, users will accept predatory terms they would reject in other contexts.

This represents a sophisticated form of exploitation that uses career necessity rather than just legal manipulation to extract value from users.

EDUCATIONAL VALUE:

LinkedIn serves as an example of professional predation - how platforms leverage career dependency. When users see:
- Perpetual professional content licenses
- Professional liability disclaimers
- Professional identity control powers
- Career-critical data abandonment clauses
- Geographic legal restrictions

They should recognize this as exploitation of professional necessity - what happens when career advancement becomes dependent on platform participation.

The critical question: "Why does my professional networking platform need more rights to my career content than my actual employer has?"

Source: ToS Salad Transparency Research
Educational Purpose: Exposing professional predation through career dependency
Analysis Category: Professional platform exploitation without forced arbitration`;

  try {
    // Create or get LinkedIn company record
    let companyId;
    const { data: existingCompany, error: companyError } = await supabase
      .from('tos_analysis_companies')
      .select('id')
      .eq('domain', 'linkedin.com')
      .single();

    if (companyError || !existingCompany) {
      const { data: newCompany, error: createError } = await supabase
        .from('tos_analysis_companies')
        .insert({
          name: 'LinkedIn Corporation (Microsoft)',
          domain: 'linkedin.com',
          industry: 'Professional Social Networking',
          headquarters: 'Sunnyvale, CA',
          founded_year: 2003,
          tos_url: 'https://www.linkedin.com/legal/user-agreement',
          corporate_website: 'https://www.linkedin.com',
          created_at: new Date().toISOString()
        })
        .select()
        .single();

      if (createError) {
        console.error('‚ùå LinkedIn company creation failed:', createError.message);
        return;
      }
      companyId = newCompany.id;
      console.log('‚úÖ LinkedIn Corporation company created');
    } else {
      companyId = existingCompany.id;
      console.log('‚úÖ Found existing LinkedIn company');
    }

    // Create LinkedIn ToS document
    const { data: document, error: docError } = await supabase
      .from('tos_analysis_documents')
      .insert({
        company_id: companyId,
        document_type: 'terms_of_service',
        title: 'LinkedIn User Agreement - Professional Predation Through Career Dependency',
        url: 'https://www.linkedin.com/legal/user-agreement',
        raw_content: linkedinAnalysisContent,
        cleaned_content: linkedinAnalysisContent,
        content_hash: require('crypto').createHash('md5').update(linkedinAnalysisContent).digest('hex'),
        scraped_at: new Date().toISOString(),
        http_status: 200,
        content_length: linkedinAnalysisContent.length,
        content_type: 'text/html',
        is_analyzed: true
      })
      .select()
      .single();

    if (docError) {
      console.error('‚ùå LinkedIn document creation failed:', docError.message);
      return;
    }

    console.log('‚úÖ LinkedIn professional predation document created');

    // Create professional predation analysis entry
    const { data: analysis, error: analysisError } = await supabase
      .from('tos_analysis_results')
      .insert({
        document_id: document.id,
        company_id: companyId,
        transparency_score: 25, // Professional predation level
        user_friendliness_score: 20, // Career-hostile terms
        privacy_score: 18, // Poor privacy protection
        manipulation_risk_score: 78, // High manipulation through career dependency
        data_collection_risk: 'high', // Professional data mining
        data_sharing_risk: 'high', // Transferable content licenses
        account_termination_risk: 'high', // Career-ending termination power
        legal_jurisdiction_risk: 'medium', // California courts only, but still courts
        concerning_clauses: [
          {category: 'Professional Content License', concern: 'Perpetual rights to all professional content including resumes and articles'},
          {category: 'Professional Liability Disclaimer', concern: 'No responsibility for career damage from platform failures'},
          {category: 'Professional Warranty Disclaimer', concern: 'No guarantees that career-critical platform will work'},
          {category: 'Geographic Legal Restriction', concern: 'Must sue in California only - practical barrier to legal recourse'},
          {category: 'Professional Identity Control', concern: 'Unilateral power to terminate professional networking access'},
          {category: 'Professional Data Abandonment', concern: 'No obligation to preserve career-critical information'}
        ],
        manipulation_tactics: [
          'Career Dependency Exploitation',
          'Professional Content Appropriation',
          'Professional Risk Transfer',
          'Professional Identity Control',
          'Geographic Legal Barriers',
          'Professional Data Abandonment'
        ],
        ai_model_used: 'tos-salad-professional-predation-analysis',
        analysis_version: '1.0.0',
        analyzed_at: new Date().toISOString(),
        executive_summary: 'LinkedIn leverages career dependency to extract professional content while maintaining control over professional identities. Professional predation without forced arbitration but with significant power imbalances.',
        key_concerns: [
          'Professional Content Theft: Perpetual Rights to Career Expertise',
          'Career Risk Transfer: No Responsibility for Professional Damage',
          'Professional Identity Control: Unilateral Account Termination Power',
          'Professional Data Loss: No Obligation to Preserve Career Information',
          'Geographic Legal Barriers: California Courts Only',
          'Career Dependency Exploitation: Leverage Professional Necessity'
        ],
        recommendations: [
          'POSITIVE: LinkedIn does NOT use forced arbitration (unlike Verizon/Chase)',
          'RISK: Your professional content becomes LinkedIn property forever',
          'CAREER: Platform failures that damage your career are your problem',
          'BACKUP: LinkedIn has no obligation to preserve your professional data',
          'LEGAL: Must sue in California only - practical barrier to justice',
          'TERMINATION: LinkedIn can end your professional presence unilaterally',
          'COMPARISON: Signal proves user-centric platforms preserve user rights',
          'DEPENDENCY: Consider diversifying professional networking beyond single platform'
        ]
      })
      .select()
      .single();

    if (analysisError) {
      console.error('‚ùå LinkedIn analysis creation failed:', analysisError.message);
      return;
    }

    console.log('‚úÖ LinkedIn professional predation analysis created');
    console.log(`üíº Transparency Score: ${analysis.transparency_score}/100 (PROFESSIONAL PREDATION)`);
    console.log(`‚ö†Ô∏è Manipulation Risk: ${analysis.manipulation_risk_score}/100 (HIGH)`);
    console.log(`üõ°Ô∏è Privacy Score: ${analysis.privacy_score}/100 (POOR)`);
    console.log(`üë§ User Friendliness: ${analysis.user_friendliness_score}/100 (CAREER-HOSTILE)`);
    console.log('üíº LinkedIn professional predation analysis successfully added!');

    console.log('\nüíº LINKEDIN: PROFESSIONAL PREDATION THROUGH CAREER DEPENDENCY');
    console.log('==============================================================');
    console.log('üéì Professional Platform Exploitation Analysis');
    console.log('üìä Source: ToS Salad Transparency Research');
    console.log('üéØ Purpose: Exposing career dependency exploitation');
    console.log('üí° Key Insight: Career necessity enables sophisticated content extraction');
    console.log('üîó Impact: Shows how professional platforms leverage career dependency');

    console.log('\nüíº LinkedIn professional predation features:');
    console.log('  ‚úÖ POSITIVE: No forced arbitration (unlike Verizon/Chase/Spotify)');
    console.log('  üìÑ Perpetual rights to all professional content and expertise');
    console.log('  üíº No responsibility for career damage from platform failures');
    console.log('  üåç Must sue in California only (practical barrier to justice)');
    console.log('  üö´ Unilateral power to terminate professional networking access');
    console.log('  üíæ No obligation to preserve career-critical information');
    console.log('  üéØ Sophisticated exploitation through career necessity dependency');

  } catch (error) {
    console.error('‚ùå LinkedIn professional predation analysis failed:', error.message);
  }
}

addLinkedInProfessionalPredation();